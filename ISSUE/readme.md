# âœ’ï¸ISSUE

<details>
  <summary><strong>&nbsp;Table of Contents</strong></summary>

&nbsp;  
[GCP](#1-gcp-ğŸŒ)<br/>
[Agent](#2-agent-ğŸ˜)<br/>
[Environment](#3-environment)<br/>
[Others](#others-ğŸ¼)<br/>

</details>


## 1. GCP ğŸŒ

`pyvirtualdisplay` ëŠ” ë¦¬ëˆ…ìŠ¤ì˜ display í™˜ê²½ì—ì„œë§Œ ì‘ë™.
ë•Œë¬¸ì— GCP ë‚´ë¶€ jupyter notebook ì—ì„œ  
íŠ¹ì • íŒ¨í‚¤ì§€ ì„¤ì¹˜ í›„ agent ë¥¼ ì‹œê°í™” í•˜ì˜€ë‹¤.

ìš°ë¦¬ê°€ êµ¬ì¶•í•œ ê°€ìƒí™˜ê²½ì˜ ìˆœì„œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

1. GCPë¡œ ê°€ìƒí™˜ê²½ êµ¬ì¶•  
- GCPì— ì ‘ì†í•´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.
- ê³ ì • IP ì™€ ë°©í™”ë²½ì„ ì„¤ì •í•œë‹¤
- ì•„ë‚˜ì½˜ë‹¤ë¥¼ ì„¤ì¹˜í•˜ê³  ê°€ìƒí™˜ê²½ì„ êµ¬ì¶•í•œë‹¤.
- ì¥¬í”¼í„° ë…¸íŠ¸ë¶ì„ ì„¤ì •í•œë‹¤.

ìì„¸í•œ GCP ì‚¬ìš©ë°©ë²•ì€ [ë§í¬](https://www.notion.so/GCP-e48565c2fe7c46c3888fbe28ccb3409b) ë¥¼ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

2. display ëª¨ë“ˆ ì„¤ì¹˜  
ë¦¬ëˆ…ìŠ¤ ì°½ì—ì„œ   
ë‹¤ìŒì˜ display ê´€ë ¨ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•œë‹¤.
- `sudo apt install xvfb`  
- `sudo apt install ffmpeg`  
- `sudo apt-get update`   
- `sudo apt-get install freeglut3-dev`  

3. jupyter open
ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¡œ jupyter notebook ì„ ì‹¤í–‰í•œë‹¤.
- `xvfb-run -a jupyter notebook`

## 2. Agent ğŸ˜

ì „ì²´ì ìœ¼ë¡œ value based ì½”ë“œì¸ 

DQN ê³¼

policy based ì¸

A2C, A3C, PPO ë¥¼ êµ¬ì¶•í•´ ë³´ì•˜ë‹¤.

DQN ì€ í•´ë‹¹ state ì—ì„œ Deterministic í•œ ê²°ê³¼ë¥¼,

policy based ëŠ” stochastic í•œ ê²°ê³¼ë¥¼,

ê·¸ ì¤‘ì—ì„œë„ íŠ¹íˆ A3C ëŠ” multi-processing ì„ ì´ìš©í•˜ê³ 
PPO ëŠ” clip ë°©ë²• ê³¼ GAE train ë°©ë²• ê°œì„ ì„  í†µí•´ ì„±ëŠ¥ì„ ì˜¬ë ¸ë‹¤.

íŠ¹íˆ CNN ë„ì…ì— ìˆì–´ì„œ 
Atari ë…¼ë¬¸ê³¼ 
í•œë™ëŒ€í•™êµ í•™ë¶€ìƒì˜ ë±€ê²Œì„ ê°•í™”í•™ìŠµ í”„ë¡œì íŠ¸ë¥¼ í† ëŒ€ë¡œ êµ¬ìƒ ì¤‘ì— ìˆë‹¤.

Atari ë…¼ë¬¸ : [ì—¬ê¸°](https://github.com/Neo-47/Atari-DQN/blob/master/Estimator.py)

ë±€ê²Œì„ ì½”ë“œ : [ì—¬ê¸°](https://github.com/choyi0521/snake-reinforcement-learning)



## 3. Environment

**1. ì•„ì´í…œ Get**
ì²«ë²ˆì§¸ë¡œ í™˜ê²½ì—ì„œ ì•„ì´í…œì˜ ìˆœì„œë¥¼ ì •í•´ì£¼ì—ˆë‹¤. ë‹¤ì‹œë§í•´ ìš°ë¦¬ê°€ ì •í•´ì£¼ëŠ” ì•„ì´í…œë¶€í„° ë¨¹ì–´ì•¼ í•˜ëŠ” ìƒíƒœ.
ë‘ë²ˆì§¸ë¡œëŠ” ìˆœì„œ ìƒê´€ì—†ì´ ëª¨ë“  ì•„ì´í…œì„ ë¨¹ì„ ìˆ˜ ìˆë„ë¡ ë°”ê¿”ì£¼ì—ˆë‹¤.  
ê·¸ ë°©ë²•ì´ ê²½ìš°ì˜ ìˆ˜ê°€ ë” ë§ì´ ìƒê²¨ ëª¨ë“  ì•„ì´í…œì„ ë¨¹ëŠ” ê²½ìš°ë¥¼ í•™ìŠµí•  ìˆ˜ ìˆë‹¤ê³  íŒë‹¨í–ˆë‹¤.

**2. ì¢Œí‘œê°’**

ì²˜ìŒì—ëŠ” 0ê³¼ 1, 100ê³¼ 150 ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆì—ˆë‹¤.
ì´ê²ƒì„ 0~255ì˜ í‘ë°±ë°ì´í„°ë¼ê³  ê°€ì •í•˜ê³ 
ê¸¸ 1 , item : 150. ì¥ì• ë¬¼ ë° ì•„ì´í…œì´ ì—†ëŠ” ì°½ê³  : 50 ìœ¼ë¡œ sclae up, ë‹¨ìˆœí™” ì²˜ë¦¬ë¥¼ í•˜ì˜€ë‹¤.
ì›ë˜ëŠ” 0 ì—ì„œ 1 ì‚¬ì´ì˜ ê°’ì„ ì •í•´ì£¼ì—ˆì§€ë§Œ, ì†Œìˆ˜ì ì—ì„œëŠ” ë‹¤ì–‘í•œ ë¬¸ì œê°€ ìˆì–´ ì¬ìˆ˜ì •í•˜ì˜€ë‹¤.

**3. ë³´ìƒ**

ì²«ë²ˆì§¸ë¡œ ëª¨ë“  í–‰ë™ì— ì–‘ìˆ˜ì˜ ë³´ìƒì„ ì£¼ì—ˆë‹¤.
ë‘ë²ˆì§¸ë¡œ ì›€ì§ì„ì€ -1. ì¥ì• ë¬¼ì€ -10. ì™„ìˆ˜ì‹œ 200ì˜ ë³´ìƒì„ ì£¼ì—ˆë‹¤.

ë‹¤ë§Œ ë³´ìƒì„ ë°›ì„ ë°©ë²•ì´ ë„ˆë¬´ ì ê¸° ë•Œë¬¸ì— ì•„ì´í…œì˜ ë³´ìƒê°’ì„ ê·¹ë‹¨ì¹˜ë¡œ ì˜¬ë ¤ë³´ê¸°ë„ í•˜ì˜€ì§€ë§Œ  
í¬ê²Œ ìœ ì˜ë¯¸í•˜ì§€ ì•Šì•˜ë‹¤.

ì„¸ë²ˆì§¸ë¡œëŠ” ëª¨ë“  ì•„ì´í…œì„ ë¨¹ì—ˆì„ ë•Œ ì¶”ê°€ ë³´ìƒìœ¼ë¡œ 300 ì„ ì£¼ì—ˆë‹¤.

**4. ì•¡ì…˜ ì œí•œ**

ì²˜ìŒì—ëŠ” ì•¡ì…˜ ì œí•œì„ ì£¼ì§€ ì•Šì•˜ì§€ë§Œ, 
ì•½ 500 ~ 3000ì˜ ìˆ˜ë¥¼ ë‘ê³  ì œí•œì„ í•˜ê³  ìˆë‹¤.

action ìˆ˜ê°€ ì§€ì •í•œ ìˆ˜ë§Œí¼ ë„˜ì—ˆì„ ë•Œ, break í•œë‹¤.

ìš°ë¦¬ì˜ ê³¼ì œ ìƒ ìˆ˜ë¥¼ 100 ì •ë„ë§Œ ë‘ì–´ë„ ì¶©ë¶„í•˜ë‹¤ê³  ìƒê°í•˜ì§€ë§Œ,
ì‹¤ì œ í•™ìŠµì‹œì—ëŠ” ê·¸ë ‡ì§€ ì•Šì•˜ìŒì„ í™•ì¸í–ˆë‹¤.

**5. Episode ë‹¨ì¼í™”**

í•œë²ˆì— ì—¬ëŸ¬ ê²½ìš°ì˜ ìˆ˜ë¥¼ í•™ìŠµí•˜ëŠ” ê²ƒì´ ì–´ë ¤ìš¸ê¹Œë´  
ìš°ì„  1ë²ˆ Epi ì— ëŒ€í•´ í•™ìŠµí•œ ë’¤ ê·¸ íŒŒë¼ë¯¸í„°ë¡œ
ë‚˜ë¨¸ì§€ train ë°ì´í„°ë¥¼ í•™ìŠµí•˜ëŠ” ê²ƒì´ ì‰¬ìš¸ ê²ƒì´ë¼ê³  íŒë‹¨í–ˆë‹¤.

ì™œëƒí•˜ë©´ ë§ˆì§€ë§‰ì— ë„ì°©ì§€ë¡œ ëŒì•„ì˜¤ëŠ” ê³¼ì • ë“± ê²¹ì¹˜ëŠ” ì§€ì ì´ ë§ê¸° ë•Œë¬¸ì´ë‹¤.


## Others ğŸ¼

**1. from string import `ascii_ string`**

íŒŒì´ì¬ì—ì„œëŠ” ê¸°ë³¸ ì•ŒíŒŒë²³ì´ë‚˜ ìˆ«ì ë°ì´í„° ì •ë„ëŠ” ìƒìˆ˜ë¡œ ì •ì˜ë˜ì–´ ìˆë‹¤.


```python
import string 

string.ascii_lowercase # ì†Œë¬¸ì abcdefghijklmnopqrstuvwxyz
string.ascii_uppercase # ëŒ€ë¬¸ì ABCDEFGHIJKLMNOPQRSTUVWXYZ
string.ascii_letters # ëŒ€ì†Œë¬¸ì ëª¨ë‘ abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ
string.digits # ìˆ«ì 0123456789


```




    '0123456789'



**2. ë‹¤ì–‘í•œ ë°°ì—´ ì²˜ë¦¬ ì˜¤ë¥˜**

- `tensor(list)` ë¥¼ ì‚¬ìš©í•˜ë©´ì„œ ìƒê¸´ ì˜¤ë¥˜ :  
> expected sequence of length 90 at dim 1 (got 10)

ë¦¬ìŠ¤íŠ¸ ì•ˆì˜ ë¦¬ìŠ¤íŠ¸ë“¤ì´ 90ê°œì˜ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆëŠ”ë°, ì§€ê¸ˆ ë°›ì€ ê±´ 10ê°œì˜ ë°ì´í„°ë°–ì— ì—†ë‹¤ëŠ” ì˜ë¯¸ì˜€ë‹¤.
`reshape()` ê°€ ì•„ë‹Œ `flatten()` í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì°¨ì›ì„ ì¶•ì†Œí•´ í•´ê²°í•˜ì˜€ë‹¤.

- `gather(1, list)` ë¥¼ ì‚¬ìš©í•˜ë©´ì„œ ìƒê¸´ ì˜¤ë¥˜ :  
> Expected dtype int64 for index  

gather ë¥¼  ì“¸ ìˆ˜ ì—†ëŠ” íƒ€ì…ì´ list ì— ë“¤ì–´ìˆë‹¤ëŠ” ëœ»ì´ë‹¤.

- `tensor(array)` ì˜¤ë¥˜
> c:\Users\82102\Oha\Urien\project\Agent.py:42: UserWarning:   
Creating a tensor from a list of numpy.ndarrays is extremely slow.  
Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor.  
(Triggered internally at  ..\torch\csrc\utils\tensor_new.cpp:210.)  

array ì•ˆì— arrray í˜•ì‹ì´ 2 ê°œì´ìƒ ìˆì–´ ì†ë„ê°€ ëŠë ¤ì§ˆ ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´,  

`array = [[array([1, 2, 3, 4, 5]), array([1, 2, 3, 4, 5],[1,2,3,4,5])]`

ì´ëŸ°ì‹ìœ¼ë¡œ ë¦¬ìŠ¤íŠ¸ ì•ˆì— array ê°€ ì—¬ëŸ¬ë²ˆ ë°˜ë³µë˜ë©´ tensorí™”ì— ì¢‹ì§€ ì•Šë‹¤.

ì´ë¥¼ í•©ì³ì£¼ê¸° ìœ„í•´ì„œëŠ”  
`numpy.concatenate( array, axis=0 )`  
`numpy.stack( array, axis=0 )`  
ë“±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.


**3. GPU ì‚¬ìš© ì˜¤ë¥˜**

ê°•í™”í•™ìŠµ ì‹œì—ëŠ” ë§ì€ Epi ì‹œí–‰ì°©ì˜¤ ëì— í›Œë¥­í•œ Agent ë¥¼ ë§Œë“¤ì–´ë‚¸ë‹¤.  
ë•Œë¬¸ì— í•™ìŠµ ì‹œì˜ GPU ì‚¬ìš©ì´ ê¶Œì¥ë˜ëŠ”ë°, GPU ì‚¬ìš© ì‹œì— ì‚¬ìš©í•˜ëŠ”

`.to(devise)` ë©”ì„œë“œ ì‚¬ìš© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆë‹¤.
> 1. Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” 'ëª¨ë¸' ê³¼ 'input data' ë‘ ì¢…ë¥˜ì— cuda ì²˜ë¦¬ë¥¼ í•´ì•¼ í•œë‹¤.

> 2. Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_gather)

>3. 'float' object has no attribute 'to'

ì´ ì™¸ì—ë„ ìœ„ì™€ ê°™ì€ ì˜¤ë¥˜ê°€ ë–´ëŠ”ë°, ì´ëŠ” ìš°ë¦¬ì˜ ë„¤íŠ¸ì›Œí¬ë¥¼ í•™ìŠµì‹œí‚¬ ë•Œ,  
íŒŒë¼ë¯¸í„°ì™€ í•¨ê»˜ reward, gamma ê°™ì€ ì‹¤ìˆ˜ê°’ì„ ì´ìš©í•˜ê¸° ë•Œë¬¸ì´ë‹¤. 

Gpu ì— ì €ì¥ëœ cuda.tensor ë°ì´í„°ì™€ cpuì— ì €ì¥ëœ float ë°ì´í„°ë¥¼ ì—°ì‚°í•  ìˆ˜ëŠ” ì—†ë‹¤.  
ë•Œë¬¸ì— ìš°ë¦¬ê°€ ì´ìš©í•  float ë°ì´í„°ë„ cuda.tensor ë¡œ ë³€í™˜ì‹œì¼œì£¼ì–´ì•¼ í•œë‹¤.


